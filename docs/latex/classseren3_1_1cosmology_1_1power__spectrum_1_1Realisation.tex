\hypertarget{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation}{
\section{seren3::cosmology::power\_\-spectrum::Realisation Class Reference}
\label{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation}\index{seren3::cosmology::power\_\-spectrum::Realisation@{seren3::cosmology::power\_\-spectrum::Realisation}}
}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a66657479f264e864519470d5cca27da3}{\_\-\_\-init\_\-\_\-}
\item 
def \hyperlink{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a70cae5b4e147c06dda4f195bf11876a2}{set\_\-fft\_\-sample\_\-spacing}
\item 
def \hyperlink{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a2d7f743d7a8bad924187e6f9fe379417}{realise\_\-density}
\item 
def \hyperlink{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a0e1f42e5de6f6d530735c8fe79529dd1}{realise\_\-velocity}
\item 
def \hyperlink{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a9ba2161fc48fe4a8588f84e62e668dc0}{apply\_\-bias}
\item 
def \hyperlink{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_ae1949bbd25d64f3e15751e4f78bf845d}{window}
\item 
def \hyperlink{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_aba11124fa5b26227a07e4daa0413405a}{window1}
\item 
def \hyperlink{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a7aa3738c4f9874c56702655c77463f98}{sigmaR}
\item 
def \hyperlink{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a11401db5e3772aed682363e17a0bf8d8}{sigma8}
\item 
def \hyperlink{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a2ae0cbfd6b3781bf57b2b89188fc7cad}{binned\_\-power\_\-spectrum}
\item 
def \hyperlink{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a02f12b743f326436bd4b9a482e6f0596}{theoretical\_\-power\_\-spectrum}
\item 
def \hyperlink{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a5db10734093eab1e21e2e1162375ec65}{test\_\-sampling\_\-error}
\item 
def \hyperlink{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a3fa53f286013d68966617cb9b360e4bf}{test\_\-parseval}
\item 
\hypertarget{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a7ff9f2220ce9615f30667a7b49935a88}{
def {\bfseries test}}
\label{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a7ff9f2220ce9615f30667a7b49935a88}

\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a2ef4114865b0824078d357ad107efff5}{
{\bfseries cosmo}}
\label{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a2ef4114865b0824078d357ad107efff5}

\item 
\hypertarget{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a391bdcfa7f8f75296b022a1eef69b7ac}{
{\bfseries x}}
\label{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a391bdcfa7f8f75296b022a1eef69b7ac}

\item 
\hypertarget{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a7de9d8598a2810796bb85709c252b756}{
{\bfseries N}}
\label{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a7de9d8598a2810796bb85709c252b756}

\item 
\hypertarget{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a134bca39e4d44196e79a9eb7aa7e901e}{
{\bfseries L}}
\label{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a134bca39e4d44196e79a9eb7aa7e901e}

\item 
\hypertarget{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_af6ce836b6c2c34f77a2a9b09d493baa9}{
{\bfseries boxfactor}}
\label{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_af6ce836b6c2c34f77a2a9b09d493baa9}

\item 
\hypertarget{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a8d791275546207943faa1c5f1735ebc2}{
{\bfseries kmin}}
\label{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a8d791275546207943faa1c5f1735ebc2}

\item 
\hypertarget{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a088798ddf94a280d491393a7dd237a33}{
{\bfseries kmax}}
\label{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a088798ddf94a280d491393a7dd237a33}

\item 
\hypertarget{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a0a7dfb8709de34c8ebc0fc2df2f1fca4}{
{\bfseries kx}}
\label{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a0a7dfb8709de34c8ebc0fc2df2f1fca4}

\item 
\hypertarget{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a425f7d8794cab01391a8ddd7fb2dd50d}{
{\bfseries ky}}
\label{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a425f7d8794cab01391a8ddd7fb2dd50d}

\item 
\hypertarget{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a35e83c95eff86ba0ef9bed59d6818b84}{
{\bfseries kz}}
\label{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a35e83c95eff86ba0ef9bed59d6818b84}

\item 
\hypertarget{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a069501387fe3416eced6b8e02ac109b8}{
{\bfseries k}}
\label{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a069501387fe3416eced6b8e02ac109b8}

\item 
\hypertarget{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_aad2c15ec18f969a0a98d0b5553620921}{
{\bfseries delta\_\-k}}
\label{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_aad2c15ec18f969a0a98d0b5553620921}

\item 
\hypertarget{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a18d623ea9f0cfa3e02982d907351b159}{
{\bfseries delta\_\-x}}
\label{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a18d623ea9f0cfa3e02982d907351b159}

\end{DoxyCompactItemize}


\subsection{Member Function Documentation}
\hypertarget{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a66657479f264e864519470d5cca27da3}{
\index{seren3::cosmology::power\_\-spectrum::Realisation@{seren3::cosmology::power\_\-spectrum::Realisation}!\_\-\_\-init\_\-\_\-@{\_\-\_\-init\_\-\_\-}}
\index{\_\-\_\-init\_\-\_\-@{\_\-\_\-init\_\-\_\-}!seren3::cosmology::power_spectrum::Realisation@{seren3::cosmology::power\_\-spectrum::Realisation}}
\subsubsection[{\_\-\_\-init\_\-\_\-}]{\setlength{\rightskip}{0pt plus 5cm}def seren3::cosmology::power\_\-spectrum::Realisation::\_\-\_\-init\_\-\_\- ( {\em self}, \/   {\em cosmo} = {\ttfamily DEFAULT\_\-COSMOLOGY}, \/   {\em scale} = {\ttfamily 0.2}, \/   {\em nsamp} = {\ttfamily 128}, \/   {\em filename} = {\ttfamily None}, \/   {\em cols} = {\ttfamily None})}}
\label{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a66657479f264e864519470d5cca27da3}
\begin{DoxyVerb}Initialise a 3D box with matter distribution described by a given power spectrum.
Parameters:
    scale (float): Boxsize (Mpc)
    nsamp (int): Number of cells per dimension
\end{DoxyVerb}
 \hypertarget{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a9ba2161fc48fe4a8588f84e62e668dc0}{
\index{seren3::cosmology::power\_\-spectrum::Realisation@{seren3::cosmology::power\_\-spectrum::Realisation}!apply\_\-bias@{apply\_\-bias}}
\index{apply\_\-bias@{apply\_\-bias}!seren3::cosmology::power_spectrum::Realisation@{seren3::cosmology::power\_\-spectrum::Realisation}}
\subsubsection[{apply\_\-bias}]{\setlength{\rightskip}{0pt plus 5cm}def seren3::cosmology::power\_\-spectrum::Realisation::apply\_\-bias ( {\em self}, \/   {\em k\_\-b}, \/   {\em b})}}
\label{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a9ba2161fc48fe4a8588f84e62e668dc0}
\begin{DoxyVerb}Apply a bias to the realisations power spectrum, and recompute the 3D field.
Parameters:
    b (array): bias to deconvolve with the delta_x field, such that:
    delta_x = ifft(delta_k/b)
\end{DoxyVerb}
 \hypertarget{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a2ae0cbfd6b3781bf57b2b89188fc7cad}{
\index{seren3::cosmology::power\_\-spectrum::Realisation@{seren3::cosmology::power\_\-spectrum::Realisation}!binned\_\-power\_\-spectrum@{binned\_\-power\_\-spectrum}}
\index{binned\_\-power\_\-spectrum@{binned\_\-power\_\-spectrum}!seren3::cosmology::power_spectrum::Realisation@{seren3::cosmology::power\_\-spectrum::Realisation}}
\subsubsection[{binned\_\-power\_\-spectrum}]{\setlength{\rightskip}{0pt plus 5cm}def seren3::cosmology::power\_\-spectrum::Realisation::binned\_\-power\_\-spectrum ( {\em self}, \/   {\em nbins} = {\ttfamily 20})}}
\label{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a2ae0cbfd6b3781bf57b2b89188fc7cad}
\begin{DoxyVerb}Return a binned power spectrum, calculated from the realisation.\end{DoxyVerb}
 \hypertarget{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a2d7f743d7a8bad924187e6f9fe379417}{
\index{seren3::cosmology::power\_\-spectrum::Realisation@{seren3::cosmology::power\_\-spectrum::Realisation}!realise\_\-density@{realise\_\-density}}
\index{realise\_\-density@{realise\_\-density}!seren3::cosmology::power_spectrum::Realisation@{seren3::cosmology::power\_\-spectrum::Realisation}}
\subsubsection[{realise\_\-density}]{\setlength{\rightskip}{0pt plus 5cm}def seren3::cosmology::power\_\-spectrum::Realisation::realise\_\-density ( {\em self}, \/   {\em filename} = {\ttfamily None}, \/   {\em cols} = {\ttfamily None})}}
\label{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a2d7f743d7a8bad924187e6f9fe379417}
\begin{DoxyVerb}Create realisation of the power spectrum by randomly sampling
from Gaussian distributions of variance P(k) for each k mode.\end{DoxyVerb}
 \hypertarget{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a0e1f42e5de6f6d530735c8fe79529dd1}{
\index{seren3::cosmology::power\_\-spectrum::Realisation@{seren3::cosmology::power\_\-spectrum::Realisation}!realise\_\-velocity@{realise\_\-velocity}}
\index{realise\_\-velocity@{realise\_\-velocity}!seren3::cosmology::power_spectrum::Realisation@{seren3::cosmology::power\_\-spectrum::Realisation}}
\subsubsection[{realise\_\-velocity}]{\setlength{\rightskip}{0pt plus 5cm}def seren3::cosmology::power\_\-spectrum::Realisation::realise\_\-velocity ( {\em self})}}
\label{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a0e1f42e5de6f6d530735c8fe79529dd1}
\begin{DoxyVerb}Realise the (unscaled) velocity field in Fourier space. See 
   Dodelson Eq. 9.18 for an expression; we factor out the 
   time-dependent quantities here. They can be added at a later stage.\end{DoxyVerb}
 \hypertarget{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a70cae5b4e147c06dda4f195bf11876a2}{
\index{seren3::cosmology::power\_\-spectrum::Realisation@{seren3::cosmology::power\_\-spectrum::Realisation}!set\_\-fft\_\-sample\_\-spacing@{set\_\-fft\_\-sample\_\-spacing}}
\index{set\_\-fft\_\-sample\_\-spacing@{set\_\-fft\_\-sample\_\-spacing}!seren3::cosmology::power_spectrum::Realisation@{seren3::cosmology::power\_\-spectrum::Realisation}}
\subsubsection[{set\_\-fft\_\-sample\_\-spacing}]{\setlength{\rightskip}{0pt plus 5cm}def seren3::cosmology::power\_\-spectrum::Realisation::set\_\-fft\_\-sample\_\-spacing ( {\em self})}}
\label{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a70cae5b4e147c06dda4f195bf11876a2}
\begin{DoxyVerb}Calculate the sample spacing in Fourier space, given some symmetric 3D 
box in real space, with 1D grid point coordinates 'x'.\end{DoxyVerb}
 \hypertarget{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a11401db5e3772aed682363e17a0bf8d8}{
\index{seren3::cosmology::power\_\-spectrum::Realisation@{seren3::cosmology::power\_\-spectrum::Realisation}!sigma8@{sigma8}}
\index{sigma8@{sigma8}!seren3::cosmology::power_spectrum::Realisation@{seren3::cosmology::power\_\-spectrum::Realisation}}
\subsubsection[{sigma8}]{\setlength{\rightskip}{0pt plus 5cm}def seren3::cosmology::power\_\-spectrum::Realisation::sigma8 ( {\em self})}}
\label{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a11401db5e3772aed682363e17a0bf8d8}
\begin{DoxyVerb}Get variance of matter perturbations on smoothing scale of 
   8 h^-1 Mpc.\end{DoxyVerb}
 \hypertarget{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a7aa3738c4f9874c56702655c77463f98}{
\index{seren3::cosmology::power\_\-spectrum::Realisation@{seren3::cosmology::power\_\-spectrum::Realisation}!sigmaR@{sigmaR}}
\index{sigmaR@{sigmaR}!seren3::cosmology::power_spectrum::Realisation@{seren3::cosmology::power\_\-spectrum::Realisation}}
\subsubsection[{sigmaR}]{\setlength{\rightskip}{0pt plus 5cm}def seren3::cosmology::power\_\-spectrum::Realisation::sigmaR ( {\em self}, \/   {\em R})}}
\label{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a7aa3738c4f9874c56702655c77463f98}
\begin{DoxyVerb}Get variance of matter perturbations, smoothed with a tophat filter 
   of radius R h^-1 Mpc.\end{DoxyVerb}
 \hypertarget{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a3fa53f286013d68966617cb9b360e4bf}{
\index{seren3::cosmology::power\_\-spectrum::Realisation@{seren3::cosmology::power\_\-spectrum::Realisation}!test\_\-parseval@{test\_\-parseval}}
\index{test\_\-parseval@{test\_\-parseval}!seren3::cosmology::power_spectrum::Realisation@{seren3::cosmology::power\_\-spectrum::Realisation}}
\subsubsection[{test\_\-parseval}]{\setlength{\rightskip}{0pt plus 5cm}def seren3::cosmology::power\_\-spectrum::Realisation::test\_\-parseval ( {\em self})}}
\label{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a3fa53f286013d68966617cb9b360e4bf}
\begin{DoxyVerb}Ensure that Parseval's theorem is satisfied for delta_x and delta_k, 
   i.e. <delta_x^2> = Sum_k[P(k)]. Important consistency check for FT;
   should return unity if everything is OK.
\end{DoxyVerb}
 \hypertarget{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a5db10734093eab1e21e2e1162375ec65}{
\index{seren3::cosmology::power\_\-spectrum::Realisation@{seren3::cosmology::power\_\-spectrum::Realisation}!test\_\-sampling\_\-error@{test\_\-sampling\_\-error}}
\index{test\_\-sampling\_\-error@{test\_\-sampling\_\-error}!seren3::cosmology::power_spectrum::Realisation@{seren3::cosmology::power\_\-spectrum::Realisation}}
\subsubsection[{test\_\-sampling\_\-error}]{\setlength{\rightskip}{0pt plus 5cm}def seren3::cosmology::power\_\-spectrum::Realisation::test\_\-sampling\_\-error ( {\em self})}}
\label{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a5db10734093eab1e21e2e1162375ec65}
\begin{DoxyVerb}P(k) is sampled within some finite window in the interval 
   [kmin, kmax], where kmin=2pi/L and kmax=2pi*sqrt(3)*(N/2)*(1/L) 
   (for 3D FT). The lack of sampling in some regions of k-space means 
   that sigma8 can't be perfectly reconstructed (see U-L. Pen, 
   arXiv:astro-ph/9709261 for a discussion).
   This function calculates sigma8 from the realised box, and compares 
   this with the theoretical calculation for sigma8 over a large 
   k-window, and over a k-window of the same size as for the box.
\end{DoxyVerb}
 \hypertarget{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a02f12b743f326436bd4b9a482e6f0596}{
\index{seren3::cosmology::power\_\-spectrum::Realisation@{seren3::cosmology::power\_\-spectrum::Realisation}!theoretical\_\-power\_\-spectrum@{theoretical\_\-power\_\-spectrum}}
\index{theoretical\_\-power\_\-spectrum@{theoretical\_\-power\_\-spectrum}!seren3::cosmology::power_spectrum::Realisation@{seren3::cosmology::power\_\-spectrum::Realisation}}
\subsubsection[{theoretical\_\-power\_\-spectrum}]{\setlength{\rightskip}{0pt plus 5cm}def seren3::cosmology::power\_\-spectrum::Realisation::theoretical\_\-power\_\-spectrum ( {\em self})}}
\label{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_a02f12b743f326436bd4b9a482e6f0596}
\begin{DoxyVerb}Calculate the theoretical power spectrum for the given cosmological 
   parameters, using Cosmolopy. Does not depend on the realisation.\end{DoxyVerb}
 \hypertarget{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_ae1949bbd25d64f3e15751e4f78bf845d}{
\index{seren3::cosmology::power\_\-spectrum::Realisation@{seren3::cosmology::power\_\-spectrum::Realisation}!window@{window}}
\index{window@{window}!seren3::cosmology::power_spectrum::Realisation@{seren3::cosmology::power\_\-spectrum::Realisation}}
\subsubsection[{window}]{\setlength{\rightskip}{0pt plus 5cm}def seren3::cosmology::power\_\-spectrum::Realisation::window ( {\em self}, \/   {\em k}, \/   {\em R})}}
\label{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_ae1949bbd25d64f3e15751e4f78bf845d}
\begin{DoxyVerb}Fourier transform of tophat window function, used to calculate 
   sigmaR etc. See "Cosmology", S. Weinberg, Eq.8.1.46.\end{DoxyVerb}
 \hypertarget{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_aba11124fa5b26227a07e4daa0413405a}{
\index{seren3::cosmology::power\_\-spectrum::Realisation@{seren3::cosmology::power\_\-spectrum::Realisation}!window1@{window1}}
\index{window1@{window1}!seren3::cosmology::power_spectrum::Realisation@{seren3::cosmology::power\_\-spectrum::Realisation}}
\subsubsection[{window1}]{\setlength{\rightskip}{0pt plus 5cm}def seren3::cosmology::power\_\-spectrum::Realisation::window1 ( {\em self}, \/   {\em k}, \/   {\em R})}}
\label{classseren3_1_1cosmology_1_1power__spectrum_1_1Realisation_aba11124fa5b26227a07e4daa0413405a}
\begin{DoxyVerb}Fourier transform of tophat window function, used to calculate 
   sigmaR etc. See "Cosmology", S. Weinberg, Eq.8.1.46.\end{DoxyVerb}
 

The documentation for this class was generated from the following file:\begin{DoxyCompactItemize}
\item 
cosmology/power\_\-spectrum.py\end{DoxyCompactItemize}
